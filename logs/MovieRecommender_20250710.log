2025-07-10 13:31:12,853 - MovieRecommender - INFO - logger:_log:507 - 日志记录器初始化完成 - 目录: logs, 级别: INFO
2025-07-10 13:31:53,963 - MovieRecommender - INFO - logger:_log:507 - 日志记录器初始化完成 - 目录: logs, 级别: INFO
2025-07-10 13:32:19,942 - MovieRecommender - INFO - logger:_log:507 - 日志记录器初始化完成 - 目录: logs, 级别: INFO
2025-07-10 13:32:55,442 - MovieRecommender - INFO - logger:_log:507 - 日志记录器初始化完成 - 目录: logs, 级别: INFO
2025-07-10 13:32:56,242 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133256/config.json
2025-07-10 13:32:56,242 - MovieRecommender - INFO - logger:_log:507 - 创建实验: LightGBM_CORAL_20250710_133256
2025-07-10 13:32:56,242 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133256/config.json
2025-07-10 13:32:56,242 - MovieRecommender - INFO - logger:_log:507 - 开始执行推荐系统模型训练与评估
2025-07-10 13:32:56,242 - MovieRecommender - INFO - logger:_log:507 - Step 1: 加载数据
2025-07-10 13:32:56,242 - MovieRecommender - INFO - logger:_log:507 - 开始加载数据文件...
2025-07-10 13:32:56,242 - MovieRecommender - INFO - logger:_log:507 - 加载评分数据: /Users/ming/Desktop/ml-latest-small/ratings.csv
2025-07-10 13:32:56,347 - MovieRecommender - INFO - logger:_log:507 - 提取时间特征...
2025-07-10 13:32:56,374 - MovieRecommender - INFO - logger:_log:507 - 加载电影数据: /Users/ming/Desktop/ml-latest-small/movies.csv
2025-07-10 13:32:56,379 - MovieRecommender - INFO - logger:_log:507 - 加载标签数据: /Users/ming/Desktop/ml-latest-small/tags.csv
2025-07-10 13:32:56,380 - MovieRecommender - INFO - logger:_log:507 - 数据加载完成:
2025-07-10 13:32:56,381 - MovieRecommender - INFO - logger:_log:507 -   - 评分记录数: 100,836
2025-07-10 13:32:56,381 - MovieRecommender - INFO - logger:_log:507 -   - 电影数量: 9,742
2025-07-10 13:32:56,381 - MovieRecommender - INFO - logger:_log:507 -   - 标签记录数: 3,683
2025-07-10 13:32:56,381 - MovieRecommender - INFO - logger:_log:507 -   - 用户数量: 610
2025-07-10 13:32:56,382 - MovieRecommender - INFO - logger:_log:507 -   - 评分范围: 0.5 - 5.0
2025-07-10 13:32:56,383 - MovieRecommender - INFO - logger:_log:507 -   - 时间范围: 1996-03-29 18:36:55 - 2018-09-24 14:27:30
2025-07-10 13:32:56,383 - MovieRecommender - INFO - logger:_log:507 - Step 2: 特征工程
2025-07-10 13:32:56,383 - MovieRecommender - INFO - logger:_log:507 - 开始创建协同过滤特征（SVD）...
2025-07-10 13:32:56,383 - MovieRecommender - INFO - logger:_log:507 - 构建用户-电影评分矩阵，评分范围: 0.5-5.0
2025-07-10 13:32:57,613 - MovieRecommender - INFO - logger:_log:507 - 训练SVD模型，隐因子维度: 20
2025-07-10 13:32:57,760 - MovieRecommender - INFO - logger:_log:507 - 协同过滤特征创建完成:
2025-07-10 13:32:57,760 - MovieRecommender - INFO - logger:_log:507 -   - 用户隐因子: (610, 21)
2025-07-10 13:32:57,760 - MovieRecommender - INFO - logger:_log:507 -   - 电影隐因子: (9724, 21)
2025-07-10 13:32:57,760 - MovieRecommender - INFO - logger:_log:507 -   - 用户偏置范围: -2.227 - 1.498
2025-07-10 13:32:57,760 - MovieRecommender - INFO - logger:_log:507 -   - 电影偏置范围: -3.002 - 1.498
2025-07-10 13:32:57,760 - MovieRecommender - INFO - logger:_log:507 -   - SVD解释方差比: 0.261
2025-07-10 13:32:57,761 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影内容特征...
2025-07-10 13:32:57,761 - MovieRecommender - INFO - logger:_log:507 - 提取电影发行年份...
2025-07-10 13:32:57,768 - MovieRecommender - INFO - logger:_log:507 - 提取标题特征...
2025-07-10 13:32:57,771 - MovieRecommender - INFO - logger:_log:507 - 处理电影类型特征...
2025-07-10 13:32:57,779 - MovieRecommender - INFO - logger:_log:507 - 合并内容特征...
2025-07-10 13:32:57,783 - MovieRecommender - INFO - logger:_log:507 - 电影内容特征创建完成:
2025-07-10 13:32:57,783 - MovieRecommender - INFO - logger:_log:507 -   - 特征维度: (9742, 28)
2025-07-10 13:32:57,784 - MovieRecommender - INFO - logger:_log:507 -   - 类型数量: 20
2025-07-10 13:32:57,784 - MovieRecommender - INFO - logger:_log:507 -   - 年份范围: 1902 - 2018
2025-07-10 13:32:57,784 - MovieRecommender - INFO - logger:_log:507 -   - 平均类型数: 2.27
2025-07-10 13:32:57,784 - MovieRecommender - INFO - logger:_log:507 - 开始创建TF-IDF标签特征...
2025-07-10 13:32:57,784 - MovieRecommender - INFO - logger:_log:507 - 预处理标签数据...
2025-07-10 13:32:57,785 - MovieRecommender - INFO - logger:_log:507 - 聚合用户-电影标签...
2025-07-10 13:32:57,804 - MovieRecommender - INFO - logger:_log:507 - 合并评分和标签数据...
2025-07-10 13:32:57,813 - MovieRecommender - INFO - logger:_log:507 - 创建TF-IDF特征，最大特征数: 100
2025-07-10 13:32:57,920 - MovieRecommender - INFO - logger:_log:507 - 创建标签统计特征...
2025-07-10 13:32:58,069 - MovieRecommender - INFO - logger:_log:507 - TF-IDF标签特征创建完成:
2025-07-10 13:32:58,069 - MovieRecommender - INFO - logger:_log:507 -   - TF-IDF特征维度: (100836, 100)
2025-07-10 13:32:58,069 - MovieRecommender - INFO - logger:_log:507 -   - 有标签的评分比例: 0.016
2025-07-10 13:32:58,069 - MovieRecommender - INFO - logger:_log:507 -   - 平均标签数量: 0.05
2025-07-10 13:32:58,069 - MovieRecommender - INFO - logger:_log:507 -   - 词汇表大小: 100
2025-07-10 13:32:58,070 - MovieRecommender - INFO - logger:_log:507 - 开始创建用户画像特征...
2025-07-10 13:32:58,071 - MovieRecommender - INFO - logger:_log:507 - 计算用户基础统计特征...
2025-07-10 13:32:58,078 - MovieRecommender - INFO - logger:_log:507 - 计算用户评分分布特征...
2025-07-10 13:32:58,122 - MovieRecommender - INFO - logger:_log:507 - 计算用户时间行为特征...
2025-07-10 13:32:58,130 - MovieRecommender - INFO - logger:_log:507 - 计算用户活跃度特征...
2025-07-10 13:32:58,133 - MovieRecommender - INFO - logger:_log:507 - 计算用户类型偏好特征...
2025-07-10 13:32:58,202 - MovieRecommender - INFO - logger:_log:507 - 合并用户特征...
2025-07-10 13:32:58,203 - MovieRecommender - INFO - logger:_log:507 - 标准化用户特征...
2025-07-10 13:32:58,204 - MovieRecommender - INFO - logger:_log:507 - 用户画像特征创建完成:
2025-07-10 13:32:58,204 - MovieRecommender - INFO - logger:_log:507 -   - 用户统计特征: (610, 26)
2025-07-10 13:32:58,204 - MovieRecommender - INFO - logger:_log:507 -   - 用户类型偏好特征: (610, 21)
2025-07-10 13:32:58,205 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:32:58,205 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.657
2025-07-10 13:32:58,210 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影画像特征...
2025-07-10 13:32:58,210 - MovieRecommender - INFO - logger:_log:507 - 计算电影基础统计特征...
2025-07-10 13:32:58,216 - MovieRecommender - INFO - logger:_log:507 - 计算电影受欢迎程度特征...
2025-07-10 13:32:58,227 - MovieRecommender - INFO - logger:_log:507 - 计算电影时间特征...
2025-07-10 13:32:58,307 - MovieRecommender - INFO - logger:_log:507 - 计算电影用户群体特征...
2025-07-10 13:32:58,504 - MovieRecommender - INFO - logger:_log:507 - 计算电影评分模式特征...
2025-07-10 13:32:58,516 - MovieRecommender - INFO - logger:_log:507 - 计算电影热度特征...
2025-07-10 13:32:58,517 - MovieRecommender - INFO - logger:_log:507 - 合并电影特征...
2025-07-10 13:32:58,522 - MovieRecommender - INFO - logger:_log:507 - 标准化电影特征...
2025-07-10 13:32:58,524 - MovieRecommender - INFO - logger:_log:507 - 电影画像特征创建完成:
2025-07-10 13:32:58,524 - MovieRecommender - INFO - logger:_log:507 -   - 电影特征维度: (9724, 31)
2025-07-10 13:32:58,524 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:32:58,524 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.262
2025-07-10 13:32:58,524 - MovieRecommender - INFO - logger:_log:507 -   - 平均用户多样性: 0.00
2025-07-10 13:32:58,524 - MovieRecommender - INFO - logger:_log:507 - 开始合并所有特征...
2025-07-10 13:32:58,526 - MovieRecommender - INFO - logger:_log:507 - 初始数据维度: (100836, 14)
2025-07-10 13:32:58,526 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征...
2025-07-10 13:32:58,543 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征后维度: (100836, 41)
2025-07-10 13:32:58,543 - MovieRecommender - INFO - logger:_log:507 - 合并协同过滤特征...
2025-07-10 13:32:58,564 - MovieRecommender - INFO - logger:_log:507 - 合并用户隐因子后维度: (100836, 61)
2025-07-10 13:32:58,582 - MovieRecommender - INFO - logger:_log:507 - 合并电影隐因子后维度: (100836, 81)
2025-07-10 13:32:58,602 - MovieRecommender - INFO - logger:_log:507 - 合并用户偏置后维度: (100836, 82)
2025-07-10 13:32:58,624 - MovieRecommender - INFO - logger:_log:507 - 合并电影偏置后维度: (100836, 83)
2025-07-10 13:32:58,624 - MovieRecommender - INFO - logger:_log:507 - 合并用户画像特征...
2025-07-10 13:32:58,650 - MovieRecommender - INFO - logger:_log:507 - 合并用户统计特征后维度: (100836, 108)
2025-07-10 13:32:58,679 - MovieRecommender - INFO - logger:_log:507 - 合并用户类型偏好后维度: (100836, 128)
2025-07-10 13:32:58,679 - MovieRecommender - INFO - logger:_log:507 - 合并电影画像特征...
2025-07-10 13:32:58,720 - MovieRecommender - INFO - logger:_log:507 - 合并电影统计特征后维度: (100836, 158)
2025-07-10 13:32:58,720 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征...
2025-07-10 13:32:58,791 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征后维度: (100836, 261)
2025-07-10 13:32:58,791 - MovieRecommender - INFO - logger:_log:507 - 跳过图结构特征合并（未提供图特征）
2025-07-10 13:32:58,791 - MovieRecommender - INFO - logger:_log:507 - 创建交叉特征...
2025-07-10 13:32:58,799 - MovieRecommender - INFO - logger:_log:507 - 创建了 20 个隐因子交叉特征
2025-07-10 13:32:58,800 - MovieRecommender - INFO - logger:_log:507 - 创建用户-电影评分交叉特征
2025-07-10 13:32:58,800 - MovieRecommender - INFO - logger:_log:507 - 创建偏置交叉特征
2025-07-10 13:32:58,801 - MovieRecommender - INFO - logger:_log:507 - 创建活跃度交叉特征
2025-07-10 13:32:58,801 - MovieRecommender - INFO - logger:_log:507 - 执行特征后处理...
2025-07-10 13:32:58,872 - MovieRecommender - INFO - logger:_log:507 - 填充缺失值: 0 -> 0
2025-07-10 13:32:59,126 - MovieRecommender - INFO - logger:_log:507 - 优化数据类型...
2025-07-10 13:32:59,197 - MovieRecommender - ERROR - logger:_log:507 - 特征合并失败: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:32:59,197 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:32:59,197 - MovieRecommender - ERROR - logger:_log:507 - 请检查配置和数据文件
2025-07-10 13:32:59,209 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败
2025-07-10 13:34:06,356 - MovieRecommender - INFO - logger:_log:507 - 日志记录器初始化完成 - 目录: logs, 级别: INFO
2025-07-10 13:34:06,649 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133406/config.json
2025-07-10 13:34:06,649 - MovieRecommender - INFO - logger:_log:507 - 创建实验: LightGBM_CORAL_20250710_133406
2025-07-10 13:34:06,650 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133406/config.json
2025-07-10 13:34:06,650 - MovieRecommender - INFO - logger:_log:507 - 开始执行推荐系统模型训练与评估
2025-07-10 13:34:06,650 - MovieRecommender - INFO - logger:_log:507 - Step 1: 加载数据
2025-07-10 13:34:06,650 - MovieRecommender - INFO - logger:_log:507 - 开始加载数据文件...
2025-07-10 13:34:06,650 - MovieRecommender - INFO - logger:_log:507 - 加载评分数据: /Users/ming/Desktop/ml-latest-small/ratings.csv
2025-07-10 13:34:06,662 - MovieRecommender - INFO - logger:_log:507 - 提取时间特征...
2025-07-10 13:34:06,676 - MovieRecommender - INFO - logger:_log:507 - 加载电影数据: /Users/ming/Desktop/ml-latest-small/movies.csv
2025-07-10 13:34:06,680 - MovieRecommender - INFO - logger:_log:507 - 加载标签数据: /Users/ming/Desktop/ml-latest-small/tags.csv
2025-07-10 13:34:06,681 - MovieRecommender - INFO - logger:_log:507 - 数据加载完成:
2025-07-10 13:34:06,681 - MovieRecommender - INFO - logger:_log:507 -   - 评分记录数: 100,836
2025-07-10 13:34:06,681 - MovieRecommender - INFO - logger:_log:507 -   - 电影数量: 9,742
2025-07-10 13:34:06,681 - MovieRecommender - INFO - logger:_log:507 -   - 标签记录数: 3,683
2025-07-10 13:34:06,681 - MovieRecommender - INFO - logger:_log:507 -   - 用户数量: 610
2025-07-10 13:34:06,681 - MovieRecommender - INFO - logger:_log:507 -   - 评分范围: 0.5 - 5.0
2025-07-10 13:34:06,682 - MovieRecommender - INFO - logger:_log:507 -   - 时间范围: 1996-03-29 18:36:55 - 2018-09-24 14:27:30
2025-07-10 13:34:06,682 - MovieRecommender - INFO - logger:_log:507 - Step 2: 特征工程
2025-07-10 13:34:06,682 - MovieRecommender - INFO - logger:_log:507 - 开始创建协同过滤特征（SVD）...
2025-07-10 13:34:06,682 - MovieRecommender - INFO - logger:_log:507 - 构建用户-电影评分矩阵，评分范围: 0.5-5.0
2025-07-10 13:34:08,013 - MovieRecommender - INFO - logger:_log:507 - 训练SVD模型，隐因子维度: 20
2025-07-10 13:34:08,114 - MovieRecommender - INFO - logger:_log:507 - 协同过滤特征创建完成:
2025-07-10 13:34:08,114 - MovieRecommender - INFO - logger:_log:507 -   - 用户隐因子: (610, 21)
2025-07-10 13:34:08,114 - MovieRecommender - INFO - logger:_log:507 -   - 电影隐因子: (9724, 21)
2025-07-10 13:34:08,114 - MovieRecommender - INFO - logger:_log:507 -   - 用户偏置范围: -2.227 - 1.498
2025-07-10 13:34:08,114 - MovieRecommender - INFO - logger:_log:507 -   - 电影偏置范围: -3.002 - 1.498
2025-07-10 13:34:08,114 - MovieRecommender - INFO - logger:_log:507 -   - SVD解释方差比: 0.261
2025-07-10 13:34:08,115 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影内容特征...
2025-07-10 13:34:08,115 - MovieRecommender - INFO - logger:_log:507 - 提取电影发行年份...
2025-07-10 13:34:08,118 - MovieRecommender - INFO - logger:_log:507 - 提取标题特征...
2025-07-10 13:34:08,122 - MovieRecommender - INFO - logger:_log:507 - 处理电影类型特征...
2025-07-10 13:34:08,127 - MovieRecommender - INFO - logger:_log:507 - 合并内容特征...
2025-07-10 13:34:08,130 - MovieRecommender - INFO - logger:_log:507 - 电影内容特征创建完成:
2025-07-10 13:34:08,130 - MovieRecommender - INFO - logger:_log:507 -   - 特征维度: (9742, 28)
2025-07-10 13:34:08,130 - MovieRecommender - INFO - logger:_log:507 -   - 类型数量: 20
2025-07-10 13:34:08,130 - MovieRecommender - INFO - logger:_log:507 -   - 年份范围: 1902 - 2018
2025-07-10 13:34:08,130 - MovieRecommender - INFO - logger:_log:507 -   - 平均类型数: 2.27
2025-07-10 13:34:08,131 - MovieRecommender - INFO - logger:_log:507 - 开始创建TF-IDF标签特征...
2025-07-10 13:34:08,131 - MovieRecommender - INFO - logger:_log:507 - 预处理标签数据...
2025-07-10 13:34:08,133 - MovieRecommender - INFO - logger:_log:507 - 聚合用户-电影标签...
2025-07-10 13:34:08,154 - MovieRecommender - INFO - logger:_log:507 - 合并评分和标签数据...
2025-07-10 13:34:08,164 - MovieRecommender - INFO - logger:_log:507 - 创建TF-IDF特征，最大特征数: 100
2025-07-10 13:34:08,277 - MovieRecommender - INFO - logger:_log:507 - 创建标签统计特征...
2025-07-10 13:34:08,388 - MovieRecommender - INFO - logger:_log:507 - TF-IDF标签特征创建完成:
2025-07-10 13:34:08,388 - MovieRecommender - INFO - logger:_log:507 -   - TF-IDF特征维度: (100836, 100)
2025-07-10 13:34:08,388 - MovieRecommender - INFO - logger:_log:507 -   - 有标签的评分比例: 0.016
2025-07-10 13:34:08,388 - MovieRecommender - INFO - logger:_log:507 -   - 平均标签数量: 0.05
2025-07-10 13:34:08,388 - MovieRecommender - INFO - logger:_log:507 -   - 词汇表大小: 100
2025-07-10 13:34:08,390 - MovieRecommender - INFO - logger:_log:507 - 开始创建用户画像特征...
2025-07-10 13:34:08,390 - MovieRecommender - INFO - logger:_log:507 - 计算用户基础统计特征...
2025-07-10 13:34:08,396 - MovieRecommender - INFO - logger:_log:507 - 计算用户评分分布特征...
2025-07-10 13:34:08,438 - MovieRecommender - INFO - logger:_log:507 - 计算用户时间行为特征...
2025-07-10 13:34:08,445 - MovieRecommender - INFO - logger:_log:507 - 计算用户活跃度特征...
2025-07-10 13:34:08,447 - MovieRecommender - INFO - logger:_log:507 - 计算用户类型偏好特征...
2025-07-10 13:34:08,550 - MovieRecommender - INFO - logger:_log:507 - 合并用户特征...
2025-07-10 13:34:08,552 - MovieRecommender - INFO - logger:_log:507 - 标准化用户特征...
2025-07-10 13:34:08,553 - MovieRecommender - INFO - logger:_log:507 - 用户画像特征创建完成:
2025-07-10 13:34:08,553 - MovieRecommender - INFO - logger:_log:507 -   - 用户统计特征: (610, 26)
2025-07-10 13:34:08,553 - MovieRecommender - INFO - logger:_log:507 -   - 用户类型偏好特征: (610, 21)
2025-07-10 13:34:08,553 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:34:08,553 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.657
2025-07-10 13:34:08,558 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影画像特征...
2025-07-10 13:34:08,558 - MovieRecommender - INFO - logger:_log:507 - 计算电影基础统计特征...
2025-07-10 13:34:08,563 - MovieRecommender - INFO - logger:_log:507 - 计算电影受欢迎程度特征...
2025-07-10 13:34:08,573 - MovieRecommender - INFO - logger:_log:507 - 计算电影时间特征...
2025-07-10 13:34:08,651 - MovieRecommender - INFO - logger:_log:507 - 计算电影用户群体特征...
2025-07-10 13:34:08,865 - MovieRecommender - INFO - logger:_log:507 - 计算电影评分模式特征...
2025-07-10 13:34:08,879 - MovieRecommender - INFO - logger:_log:507 - 计算电影热度特征...
2025-07-10 13:34:08,879 - MovieRecommender - INFO - logger:_log:507 - 合并电影特征...
2025-07-10 13:34:08,884 - MovieRecommender - INFO - logger:_log:507 - 标准化电影特征...
2025-07-10 13:34:08,885 - MovieRecommender - INFO - logger:_log:507 - 电影画像特征创建完成:
2025-07-10 13:34:08,885 - MovieRecommender - INFO - logger:_log:507 -   - 电影特征维度: (9724, 31)
2025-07-10 13:34:08,885 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:34:08,885 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.262
2025-07-10 13:34:08,885 - MovieRecommender - INFO - logger:_log:507 -   - 平均用户多样性: 0.00
2025-07-10 13:34:08,885 - MovieRecommender - INFO - logger:_log:507 - 开始合并所有特征...
2025-07-10 13:34:08,887 - MovieRecommender - INFO - logger:_log:507 - 初始数据维度: (100836, 14)
2025-07-10 13:34:08,887 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征...
2025-07-10 13:34:08,898 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征后维度: (100836, 41)
2025-07-10 13:34:08,899 - MovieRecommender - INFO - logger:_log:507 - 合并协同过滤特征...
2025-07-10 13:34:08,909 - MovieRecommender - INFO - logger:_log:507 - 合并用户隐因子后维度: (100836, 61)
2025-07-10 13:34:08,921 - MovieRecommender - INFO - logger:_log:507 - 合并电影隐因子后维度: (100836, 81)
2025-07-10 13:34:08,934 - MovieRecommender - INFO - logger:_log:507 - 合并用户偏置后维度: (100836, 82)
2025-07-10 13:34:08,949 - MovieRecommender - INFO - logger:_log:507 - 合并电影偏置后维度: (100836, 83)
2025-07-10 13:34:08,949 - MovieRecommender - INFO - logger:_log:507 - 合并用户画像特征...
2025-07-10 13:34:08,971 - MovieRecommender - INFO - logger:_log:507 - 合并用户统计特征后维度: (100836, 108)
2025-07-10 13:34:08,993 - MovieRecommender - INFO - logger:_log:507 - 合并用户类型偏好后维度: (100836, 128)
2025-07-10 13:34:08,993 - MovieRecommender - INFO - logger:_log:507 - 合并电影画像特征...
2025-07-10 13:34:09,032 - MovieRecommender - INFO - logger:_log:507 - 合并电影统计特征后维度: (100836, 158)
2025-07-10 13:34:09,032 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征...
2025-07-10 13:34:09,095 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征后维度: (100836, 261)
2025-07-10 13:34:09,095 - MovieRecommender - INFO - logger:_log:507 - 跳过图结构特征合并（未提供图特征）
2025-07-10 13:34:09,095 - MovieRecommender - INFO - logger:_log:507 - 创建交叉特征...
2025-07-10 13:34:09,101 - MovieRecommender - INFO - logger:_log:507 - 创建了 20 个隐因子交叉特征
2025-07-10 13:34:09,101 - MovieRecommender - INFO - logger:_log:507 - 创建用户-电影评分交叉特征
2025-07-10 13:34:09,102 - MovieRecommender - INFO - logger:_log:507 - 创建偏置交叉特征
2025-07-10 13:34:09,102 - MovieRecommender - INFO - logger:_log:507 - 创建活跃度交叉特征
2025-07-10 13:34:09,102 - MovieRecommender - INFO - logger:_log:507 - 执行特征后处理...
2025-07-10 13:34:09,171 - MovieRecommender - INFO - logger:_log:507 - 填充缺失值: 0 -> 0
2025-07-10 13:34:09,494 - MovieRecommender - INFO - logger:_log:507 - 优化数据类型...
2025-07-10 13:34:09,555 - MovieRecommender - ERROR - logger:_log:507 - 特征合并失败: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:34:09,555 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:34:09,555 - MovieRecommender - ERROR - logger:_log:507 - 请检查配置和数据文件
2025-07-10 13:34:09,569 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败
2025-07-10 13:35:49,789 - MovieRecommender - INFO - logger:_log:507 - 日志记录器初始化完成 - 目录: logs, 级别: INFO
2025-07-10 13:35:50,805 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133550/config.json
2025-07-10 13:35:50,805 - MovieRecommender - INFO - logger:_log:507 - 创建实验: LightGBM_CORAL_20250710_133550
2025-07-10 13:35:50,805 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133550/config.json
2025-07-10 13:35:50,805 - MovieRecommender - INFO - logger:_log:507 - 开始执行推荐系统模型训练与评估
2025-07-10 13:35:50,806 - MovieRecommender - INFO - logger:_log:507 - Step 1: 加载数据
2025-07-10 13:35:50,806 - MovieRecommender - INFO - logger:_log:507 - 开始加载数据文件...
2025-07-10 13:35:50,806 - MovieRecommender - INFO - logger:_log:507 - 加载评分数据: /Users/ming/Desktop/ml-latest-small/ratings.csv
2025-07-10 13:35:50,819 - MovieRecommender - INFO - logger:_log:507 - 提取时间特征...
2025-07-10 13:35:50,835 - MovieRecommender - INFO - logger:_log:507 - 加载电影数据: /Users/ming/Desktop/ml-latest-small/movies.csv
2025-07-10 13:35:50,839 - MovieRecommender - INFO - logger:_log:507 - 加载标签数据: /Users/ming/Desktop/ml-latest-small/tags.csv
2025-07-10 13:35:50,841 - MovieRecommender - INFO - logger:_log:507 - 数据加载完成:
2025-07-10 13:35:50,841 - MovieRecommender - INFO - logger:_log:507 -   - 评分记录数: 100,836
2025-07-10 13:35:50,841 - MovieRecommender - INFO - logger:_log:507 -   - 电影数量: 9,742
2025-07-10 13:35:50,841 - MovieRecommender - INFO - logger:_log:507 -   - 标签记录数: 3,683
2025-07-10 13:35:50,841 - MovieRecommender - INFO - logger:_log:507 -   - 用户数量: 610
2025-07-10 13:35:50,841 - MovieRecommender - INFO - logger:_log:507 -   - 评分范围: 0.5 - 5.0
2025-07-10 13:35:50,842 - MovieRecommender - INFO - logger:_log:507 -   - 时间范围: 1996-03-29 18:36:55 - 2018-09-24 14:27:30
2025-07-10 13:35:50,842 - MovieRecommender - INFO - logger:_log:507 - Step 2: 特征工程
2025-07-10 13:35:50,842 - MovieRecommender - INFO - logger:_log:507 - 开始创建协同过滤特征（SVD）...
2025-07-10 13:35:50,842 - MovieRecommender - INFO - logger:_log:507 - 构建用户-电影评分矩阵，评分范围: 0.5-5.0
2025-07-10 13:35:52,180 - MovieRecommender - INFO - logger:_log:507 - 训练SVD模型，隐因子维度: 20
2025-07-10 13:35:52,395 - MovieRecommender - INFO - logger:_log:507 - 协同过滤特征创建完成:
2025-07-10 13:35:52,395 - MovieRecommender - INFO - logger:_log:507 -   - 用户隐因子: (610, 21)
2025-07-10 13:35:52,395 - MovieRecommender - INFO - logger:_log:507 -   - 电影隐因子: (9724, 21)
2025-07-10 13:35:52,395 - MovieRecommender - INFO - logger:_log:507 -   - 用户偏置范围: -2.227 - 1.498
2025-07-10 13:35:52,395 - MovieRecommender - INFO - logger:_log:507 -   - 电影偏置范围: -3.002 - 1.498
2025-07-10 13:35:52,395 - MovieRecommender - INFO - logger:_log:507 -   - SVD解释方差比: 0.261
2025-07-10 13:35:52,396 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影内容特征...
2025-07-10 13:35:52,396 - MovieRecommender - INFO - logger:_log:507 - 提取电影发行年份...
2025-07-10 13:35:52,400 - MovieRecommender - INFO - logger:_log:507 - 提取标题特征...
2025-07-10 13:35:52,406 - MovieRecommender - INFO - logger:_log:507 - 处理电影类型特征...
2025-07-10 13:35:52,417 - MovieRecommender - INFO - logger:_log:507 - 合并内容特征...
2025-07-10 13:35:52,419 - MovieRecommender - INFO - logger:_log:507 - 电影内容特征创建完成:
2025-07-10 13:35:52,419 - MovieRecommender - INFO - logger:_log:507 -   - 特征维度: (9742, 28)
2025-07-10 13:35:52,419 - MovieRecommender - INFO - logger:_log:507 -   - 类型数量: 20
2025-07-10 13:35:52,419 - MovieRecommender - INFO - logger:_log:507 -   - 年份范围: 1902 - 2018
2025-07-10 13:35:52,419 - MovieRecommender - INFO - logger:_log:507 -   - 平均类型数: 2.27
2025-07-10 13:35:52,419 - MovieRecommender - INFO - logger:_log:507 - 开始创建TF-IDF标签特征...
2025-07-10 13:35:52,419 - MovieRecommender - INFO - logger:_log:507 - 预处理标签数据...
2025-07-10 13:35:52,425 - MovieRecommender - INFO - logger:_log:507 - 聚合用户-电影标签...
2025-07-10 13:35:52,465 - MovieRecommender - INFO - logger:_log:507 - 合并评分和标签数据...
2025-07-10 13:35:52,484 - MovieRecommender - INFO - logger:_log:507 - 创建TF-IDF特征，最大特征数: 100
2025-07-10 13:35:52,690 - MovieRecommender - INFO - logger:_log:507 - 创建标签统计特征...
2025-07-10 13:35:52,807 - MovieRecommender - INFO - logger:_log:507 - TF-IDF标签特征创建完成:
2025-07-10 13:35:52,807 - MovieRecommender - INFO - logger:_log:507 -   - TF-IDF特征维度: (100836, 100)
2025-07-10 13:35:52,808 - MovieRecommender - INFO - logger:_log:507 -   - 有标签的评分比例: 0.016
2025-07-10 13:35:52,808 - MovieRecommender - INFO - logger:_log:507 -   - 平均标签数量: 0.05
2025-07-10 13:35:52,808 - MovieRecommender - INFO - logger:_log:507 -   - 词汇表大小: 100
2025-07-10 13:35:52,810 - MovieRecommender - INFO - logger:_log:507 - 开始创建用户画像特征...
2025-07-10 13:35:52,810 - MovieRecommender - INFO - logger:_log:507 - 计算用户基础统计特征...
2025-07-10 13:35:52,817 - MovieRecommender - INFO - logger:_log:507 - 计算用户评分分布特征...
2025-07-10 13:35:52,860 - MovieRecommender - INFO - logger:_log:507 - 计算用户时间行为特征...
2025-07-10 13:35:52,869 - MovieRecommender - INFO - logger:_log:507 - 计算用户活跃度特征...
2025-07-10 13:35:52,871 - MovieRecommender - INFO - logger:_log:507 - 计算用户类型偏好特征...
2025-07-10 13:35:52,935 - MovieRecommender - INFO - logger:_log:507 - 合并用户特征...
2025-07-10 13:35:52,936 - MovieRecommender - INFO - logger:_log:507 - 标准化用户特征...
2025-07-10 13:35:52,937 - MovieRecommender - INFO - logger:_log:507 - 用户画像特征创建完成:
2025-07-10 13:35:52,937 - MovieRecommender - INFO - logger:_log:507 -   - 用户统计特征: (610, 26)
2025-07-10 13:35:52,937 - MovieRecommender - INFO - logger:_log:507 -   - 用户类型偏好特征: (610, 21)
2025-07-10 13:35:52,937 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:35:52,937 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.657
2025-07-10 13:35:52,943 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影画像特征...
2025-07-10 13:35:52,943 - MovieRecommender - INFO - logger:_log:507 - 计算电影基础统计特征...
2025-07-10 13:35:52,948 - MovieRecommender - INFO - logger:_log:507 - 计算电影受欢迎程度特征...
2025-07-10 13:35:52,960 - MovieRecommender - INFO - logger:_log:507 - 计算电影时间特征...
2025-07-10 13:35:53,041 - MovieRecommender - INFO - logger:_log:507 - 计算电影用户群体特征...
2025-07-10 13:35:53,232 - MovieRecommender - INFO - logger:_log:507 - 计算电影评分模式特征...
2025-07-10 13:35:53,243 - MovieRecommender - INFO - logger:_log:507 - 计算电影热度特征...
2025-07-10 13:35:53,244 - MovieRecommender - INFO - logger:_log:507 - 合并电影特征...
2025-07-10 13:35:53,249 - MovieRecommender - INFO - logger:_log:507 - 标准化电影特征...
2025-07-10 13:35:53,251 - MovieRecommender - INFO - logger:_log:507 - 电影画像特征创建完成:
2025-07-10 13:35:53,251 - MovieRecommender - INFO - logger:_log:507 -   - 电影特征维度: (9724, 31)
2025-07-10 13:35:53,251 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:35:53,251 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.262
2025-07-10 13:35:53,251 - MovieRecommender - INFO - logger:_log:507 -   - 平均用户多样性: 0.00
2025-07-10 13:35:53,251 - MovieRecommender - INFO - logger:_log:507 - 开始合并所有特征...
2025-07-10 13:35:53,253 - MovieRecommender - INFO - logger:_log:507 - 初始数据维度: (100836, 14)
2025-07-10 13:35:53,253 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征...
2025-07-10 13:35:53,267 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征后维度: (100836, 41)
2025-07-10 13:35:53,267 - MovieRecommender - INFO - logger:_log:507 - 合并协同过滤特征...
2025-07-10 13:35:53,282 - MovieRecommender - INFO - logger:_log:507 - 合并用户隐因子后维度: (100836, 61)
2025-07-10 13:35:53,296 - MovieRecommender - INFO - logger:_log:507 - 合并电影隐因子后维度: (100836, 81)
2025-07-10 13:35:53,310 - MovieRecommender - INFO - logger:_log:507 - 合并用户偏置后维度: (100836, 82)
2025-07-10 13:35:53,333 - MovieRecommender - INFO - logger:_log:507 - 合并电影偏置后维度: (100836, 83)
2025-07-10 13:35:53,333 - MovieRecommender - INFO - logger:_log:507 - 合并用户画像特征...
2025-07-10 13:35:53,363 - MovieRecommender - INFO - logger:_log:507 - 合并用户统计特征后维度: (100836, 108)
2025-07-10 13:35:53,394 - MovieRecommender - INFO - logger:_log:507 - 合并用户类型偏好后维度: (100836, 128)
2025-07-10 13:35:53,394 - MovieRecommender - INFO - logger:_log:507 - 合并电影画像特征...
2025-07-10 13:35:53,439 - MovieRecommender - INFO - logger:_log:507 - 合并电影统计特征后维度: (100836, 158)
2025-07-10 13:35:53,440 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征...
2025-07-10 13:35:53,512 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征后维度: (100836, 261)
2025-07-10 13:35:53,512 - MovieRecommender - INFO - logger:_log:507 - 跳过图结构特征合并（未提供图特征）
2025-07-10 13:35:53,512 - MovieRecommender - INFO - logger:_log:507 - 创建交叉特征...
2025-07-10 13:35:53,519 - MovieRecommender - INFO - logger:_log:507 - 创建了 20 个隐因子交叉特征
2025-07-10 13:35:53,528 - MovieRecommender - INFO - logger:_log:507 - 创建用户-电影评分交叉特征
2025-07-10 13:35:53,533 - MovieRecommender - INFO - logger:_log:507 - 创建偏置交叉特征
2025-07-10 13:35:53,536 - MovieRecommender - INFO - logger:_log:507 - 创建活跃度交叉特征
2025-07-10 13:35:53,537 - MovieRecommender - INFO - logger:_log:507 - 执行特征后处理...
2025-07-10 13:35:53,658 - MovieRecommender - INFO - logger:_log:507 - 填充缺失值: 0 -> 0
2025-07-10 13:35:53,919 - MovieRecommender - INFO - logger:_log:507 - 优化数据类型...
2025-07-10 13:35:53,985 - MovieRecommender - WARNING - logger:_log:507 - 无法优化列 has_tag 的数据类型: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:35:53,994 - MovieRecommender - WARNING - logger:_log:507 - 无法优化列 has_tag 的数据类型: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:35:54,002 - MovieRecommender - INFO - logger:_log:507 - 内存优化: 222.08 MB -> 112.07 MB
2025-07-10 13:35:54,002 - MovieRecommender - INFO - logger:_log:507 - 特征合并完成:
2025-07-10 13:35:54,003 - MovieRecommender - INFO - logger:_log:507 -   - 最终维度: (100836, 286)
2025-07-10 13:35:54,003 - MovieRecommender - INFO - logger:_log:507 -   - 特征数量: 282
2025-07-10 13:35:54,003 - MovieRecommender - INFO - logger:_log:507 -   - 内存使用: 112.07 MB
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - 数据完整性: 100.00%
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 - 特征分布:
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - 协同过滤: 45
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - 内容特征: 52
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - TF-IDF: 100
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - 用户画像: 25
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - 电影画像: 31
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - 图结构: 0
2025-07-10 13:35:54,021 - MovieRecommender - INFO - logger:_log:507 -   - 交叉特征: 46
2025-07-10 13:35:54,070 - MovieRecommender - INFO - logger:_log:507 - Step 3: 定义特征列
2025-07-10 13:35:54,070 - MovieRecommender - INFO - logger:_log:507 - Step 4: 划分训练集和验证集
2025-07-10 13:35:55,399 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败: "['year', '(no genres listed)', 'Action', 'Adventure', 'Animation', 'Children', 'Comedy', 'Crime', 'Documentary', 'Drama', 'Fantasy', 'Film-Noir', 'Horror', 'IMAX', 'Musical', 'Mystery', 'Romance', 'Sci-Fi', 'Thriller', 'War', 'Western'] not in index"
2025-07-10 13:35:55,399 - MovieRecommender - ERROR - logger:_log:507 - 请检查配置和数据文件
2025-07-10 13:35:55,418 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败
2025-07-10 13:36:37,861 - MovieRecommender - INFO - logger:_log:507 - 日志记录器初始化完成 - 目录: logs, 级别: INFO
2025-07-10 13:36:38,153 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133638/config.json
2025-07-10 13:36:38,153 - MovieRecommender - INFO - logger:_log:507 - 创建实验: LightGBM_CORAL_20250710_133638
2025-07-10 13:36:38,154 - MovieRecommender - INFO - logger:_log:507 - 保存实验配置到: experiments/LightGBM_CORAL_20250710_133638/config.json
2025-07-10 13:36:38,154 - MovieRecommender - INFO - logger:_log:507 - 开始执行推荐系统模型训练与评估
2025-07-10 13:36:38,154 - MovieRecommender - INFO - logger:_log:507 - Step 1: 加载数据
2025-07-10 13:36:38,154 - MovieRecommender - INFO - logger:_log:507 - 开始加载数据文件...
2025-07-10 13:36:38,154 - MovieRecommender - INFO - logger:_log:507 - 加载评分数据: /Users/ming/Desktop/ml-latest-small/ratings.csv
2025-07-10 13:36:38,166 - MovieRecommender - INFO - logger:_log:507 - 提取时间特征...
2025-07-10 13:36:38,180 - MovieRecommender - INFO - logger:_log:507 - 加载电影数据: /Users/ming/Desktop/ml-latest-small/movies.csv
2025-07-10 13:36:38,184 - MovieRecommender - INFO - logger:_log:507 - 加载标签数据: /Users/ming/Desktop/ml-latest-small/tags.csv
2025-07-10 13:36:38,185 - MovieRecommender - INFO - logger:_log:507 - 数据加载完成:
2025-07-10 13:36:38,185 - MovieRecommender - INFO - logger:_log:507 -   - 评分记录数: 100,836
2025-07-10 13:36:38,185 - MovieRecommender - INFO - logger:_log:507 -   - 电影数量: 9,742
2025-07-10 13:36:38,185 - MovieRecommender - INFO - logger:_log:507 -   - 标签记录数: 3,683
2025-07-10 13:36:38,185 - MovieRecommender - INFO - logger:_log:507 -   - 用户数量: 610
2025-07-10 13:36:38,185 - MovieRecommender - INFO - logger:_log:507 -   - 评分范围: 0.5 - 5.0
2025-07-10 13:36:38,186 - MovieRecommender - INFO - logger:_log:507 -   - 时间范围: 1996-03-29 18:36:55 - 2018-09-24 14:27:30
2025-07-10 13:36:38,186 - MovieRecommender - INFO - logger:_log:507 - Step 2: 特征工程
2025-07-10 13:36:38,186 - MovieRecommender - INFO - logger:_log:507 - 开始创建协同过滤特征（SVD）...
2025-07-10 13:36:38,186 - MovieRecommender - INFO - logger:_log:507 - 构建用户-电影评分矩阵，评分范围: 0.5-5.0
2025-07-10 13:36:39,521 - MovieRecommender - INFO - logger:_log:507 - 训练SVD模型，隐因子维度: 20
2025-07-10 13:36:39,613 - MovieRecommender - INFO - logger:_log:507 - 协同过滤特征创建完成:
2025-07-10 13:36:39,613 - MovieRecommender - INFO - logger:_log:507 -   - 用户隐因子: (610, 21)
2025-07-10 13:36:39,613 - MovieRecommender - INFO - logger:_log:507 -   - 电影隐因子: (9724, 21)
2025-07-10 13:36:39,613 - MovieRecommender - INFO - logger:_log:507 -   - 用户偏置范围: -2.227 - 1.498
2025-07-10 13:36:39,613 - MovieRecommender - INFO - logger:_log:507 -   - 电影偏置范围: -3.002 - 1.498
2025-07-10 13:36:39,613 - MovieRecommender - INFO - logger:_log:507 -   - SVD解释方差比: 0.261
2025-07-10 13:36:39,614 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影内容特征...
2025-07-10 13:36:39,614 - MovieRecommender - INFO - logger:_log:507 - 提取电影发行年份...
2025-07-10 13:36:39,617 - MovieRecommender - INFO - logger:_log:507 - 提取标题特征...
2025-07-10 13:36:39,621 - MovieRecommender - INFO - logger:_log:507 - 处理电影类型特征...
2025-07-10 13:36:39,626 - MovieRecommender - INFO - logger:_log:507 - 合并内容特征...
2025-07-10 13:36:39,630 - MovieRecommender - INFO - logger:_log:507 - 电影内容特征创建完成:
2025-07-10 13:36:39,630 - MovieRecommender - INFO - logger:_log:507 -   - 特征维度: (9742, 28)
2025-07-10 13:36:39,630 - MovieRecommender - INFO - logger:_log:507 -   - 类型数量: 20
2025-07-10 13:36:39,630 - MovieRecommender - INFO - logger:_log:507 -   - 年份范围: 1902 - 2018
2025-07-10 13:36:39,630 - MovieRecommender - INFO - logger:_log:507 -   - 平均类型数: 2.27
2025-07-10 13:36:39,631 - MovieRecommender - INFO - logger:_log:507 - 开始创建TF-IDF标签特征...
2025-07-10 13:36:39,631 - MovieRecommender - INFO - logger:_log:507 - 预处理标签数据...
2025-07-10 13:36:39,634 - MovieRecommender - INFO - logger:_log:507 - 聚合用户-电影标签...
2025-07-10 13:36:39,653 - MovieRecommender - INFO - logger:_log:507 - 合并评分和标签数据...
2025-07-10 13:36:39,662 - MovieRecommender - INFO - logger:_log:507 - 创建TF-IDF特征，最大特征数: 100
2025-07-10 13:36:39,804 - MovieRecommender - INFO - logger:_log:507 - 创建标签统计特征...
2025-07-10 13:36:39,913 - MovieRecommender - INFO - logger:_log:507 - TF-IDF标签特征创建完成:
2025-07-10 13:36:39,913 - MovieRecommender - INFO - logger:_log:507 -   - TF-IDF特征维度: (100836, 100)
2025-07-10 13:36:39,913 - MovieRecommender - INFO - logger:_log:507 -   - 有标签的评分比例: 0.016
2025-07-10 13:36:39,913 - MovieRecommender - INFO - logger:_log:507 -   - 平均标签数量: 0.05
2025-07-10 13:36:39,913 - MovieRecommender - INFO - logger:_log:507 -   - 词汇表大小: 100
2025-07-10 13:36:39,914 - MovieRecommender - INFO - logger:_log:507 - 开始创建用户画像特征...
2025-07-10 13:36:39,914 - MovieRecommender - INFO - logger:_log:507 - 计算用户基础统计特征...
2025-07-10 13:36:39,920 - MovieRecommender - INFO - logger:_log:507 - 计算用户评分分布特征...
2025-07-10 13:36:39,962 - MovieRecommender - INFO - logger:_log:507 - 计算用户时间行为特征...
2025-07-10 13:36:39,970 - MovieRecommender - INFO - logger:_log:507 - 计算用户活跃度特征...
2025-07-10 13:36:39,972 - MovieRecommender - INFO - logger:_log:507 - 计算用户类型偏好特征...
2025-07-10 13:36:40,080 - MovieRecommender - INFO - logger:_log:507 - 合并用户特征...
2025-07-10 13:36:40,082 - MovieRecommender - INFO - logger:_log:507 - 标准化用户特征...
2025-07-10 13:36:40,083 - MovieRecommender - INFO - logger:_log:507 - 用户画像特征创建完成:
2025-07-10 13:36:40,083 - MovieRecommender - INFO - logger:_log:507 -   - 用户统计特征: (610, 26)
2025-07-10 13:36:40,083 - MovieRecommender - INFO - logger:_log:507 -   - 用户类型偏好特征: (610, 21)
2025-07-10 13:36:40,083 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:36:40,083 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.657
2025-07-10 13:36:40,088 - MovieRecommender - INFO - logger:_log:507 - 开始创建电影画像特征...
2025-07-10 13:36:40,088 - MovieRecommender - INFO - logger:_log:507 - 计算电影基础统计特征...
2025-07-10 13:36:40,093 - MovieRecommender - INFO - logger:_log:507 - 计算电影受欢迎程度特征...
2025-07-10 13:36:40,104 - MovieRecommender - INFO - logger:_log:507 - 计算电影时间特征...
2025-07-10 13:36:40,181 - MovieRecommender - INFO - logger:_log:507 - 计算电影用户群体特征...
2025-07-10 13:36:40,402 - MovieRecommender - INFO - logger:_log:507 - 计算电影评分模式特征...
2025-07-10 13:36:40,414 - MovieRecommender - INFO - logger:_log:507 - 计算电影热度特征...
2025-07-10 13:36:40,414 - MovieRecommender - INFO - logger:_log:507 - 合并电影特征...
2025-07-10 13:36:40,418 - MovieRecommender - INFO - logger:_log:507 - 标准化电影特征...
2025-07-10 13:36:40,419 - MovieRecommender - INFO - logger:_log:507 - 电影画像特征创建完成:
2025-07-10 13:36:40,419 - MovieRecommender - INFO - logger:_log:507 -   - 电影特征维度: (9724, 31)
2025-07-10 13:36:40,419 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分数: 0.00
2025-07-10 13:36:40,419 - MovieRecommender - INFO - logger:_log:507 -   - 平均评分: 3.262
2025-07-10 13:36:40,419 - MovieRecommender - INFO - logger:_log:507 -   - 平均用户多样性: 0.00
2025-07-10 13:36:40,419 - MovieRecommender - INFO - logger:_log:507 - 开始合并所有特征...
2025-07-10 13:36:40,421 - MovieRecommender - INFO - logger:_log:507 - 初始数据维度: (100836, 14)
2025-07-10 13:36:40,421 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征...
2025-07-10 13:36:40,432 - MovieRecommender - INFO - logger:_log:507 - 合并电影内容特征后维度: (100836, 41)
2025-07-10 13:36:40,432 - MovieRecommender - INFO - logger:_log:507 - 合并协同过滤特征...
2025-07-10 13:36:40,441 - MovieRecommender - INFO - logger:_log:507 - 合并用户隐因子后维度: (100836, 61)
2025-07-10 13:36:40,451 - MovieRecommender - INFO - logger:_log:507 - 合并电影隐因子后维度: (100836, 81)
2025-07-10 13:36:40,461 - MovieRecommender - INFO - logger:_log:507 - 合并用户偏置后维度: (100836, 82)
2025-07-10 13:36:40,474 - MovieRecommender - INFO - logger:_log:507 - 合并电影偏置后维度: (100836, 83)
2025-07-10 13:36:40,474 - MovieRecommender - INFO - logger:_log:507 - 合并用户画像特征...
2025-07-10 13:36:40,491 - MovieRecommender - INFO - logger:_log:507 - 合并用户统计特征后维度: (100836, 108)
2025-07-10 13:36:40,512 - MovieRecommender - INFO - logger:_log:507 - 合并用户类型偏好后维度: (100836, 128)
2025-07-10 13:36:40,512 - MovieRecommender - INFO - logger:_log:507 - 合并电影画像特征...
2025-07-10 13:36:40,540 - MovieRecommender - INFO - logger:_log:507 - 合并电影统计特征后维度: (100836, 158)
2025-07-10 13:36:40,540 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征...
2025-07-10 13:36:40,594 - MovieRecommender - INFO - logger:_log:507 - 合并TF-IDF特征后维度: (100836, 261)
2025-07-10 13:36:40,594 - MovieRecommender - INFO - logger:_log:507 - 跳过图结构特征合并（未提供图特征）
2025-07-10 13:36:40,594 - MovieRecommender - INFO - logger:_log:507 - 创建交叉特征...
2025-07-10 13:36:40,601 - MovieRecommender - INFO - logger:_log:507 - 创建了 20 个隐因子交叉特征
2025-07-10 13:36:40,601 - MovieRecommender - INFO - logger:_log:507 - 创建用户-电影评分交叉特征
2025-07-10 13:36:40,602 - MovieRecommender - INFO - logger:_log:507 - 创建偏置交叉特征
2025-07-10 13:36:40,602 - MovieRecommender - INFO - logger:_log:507 - 创建活跃度交叉特征
2025-07-10 13:36:40,602 - MovieRecommender - INFO - logger:_log:507 - 执行特征后处理...
2025-07-10 13:36:40,670 - MovieRecommender - INFO - logger:_log:507 - 填充缺失值: 0 -> 0
2025-07-10 13:36:40,955 - MovieRecommender - INFO - logger:_log:507 - 优化数据类型...
2025-07-10 13:36:41,013 - MovieRecommender - WARNING - logger:_log:507 - 无法优化列 has_tag 的数据类型: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:36:41,022 - MovieRecommender - WARNING - logger:_log:507 - 无法优化列 has_tag 的数据类型: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2025-07-10 13:36:41,028 - MovieRecommender - INFO - logger:_log:507 - 内存优化: 222.85 MB -> 112.84 MB
2025-07-10 13:36:41,028 - MovieRecommender - INFO - logger:_log:507 - 特征合并完成:
2025-07-10 13:36:41,028 - MovieRecommender - INFO - logger:_log:507 -   - 最终维度: (100836, 286)
2025-07-10 13:36:41,028 - MovieRecommender - INFO - logger:_log:507 -   - 特征数量: 282
2025-07-10 13:36:41,028 - MovieRecommender - INFO - logger:_log:507 -   - 内存使用: 112.84 MB
2025-07-10 13:36:41,047 - MovieRecommender - INFO - logger:_log:507 -   - 数据完整性: 100.00%
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 - 特征分布:
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 -   - 协同过滤: 45
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 -   - 内容特征: 52
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 -   - TF-IDF: 100
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 -   - 用户画像: 25
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 -   - 电影画像: 31
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 -   - 图结构: 0
2025-07-10 13:36:41,048 - MovieRecommender - INFO - logger:_log:507 -   - 交叉特征: 46
2025-07-10 13:36:41,094 - MovieRecommender - INFO - logger:_log:507 - Step 3: 定义特征列
2025-07-10 13:36:41,094 - MovieRecommender - INFO - logger:_log:507 - Step 4: 划分训练集和验证集
2025-07-10 13:36:42,453 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败: "['year', '(no genres listed)', 'Action', 'Adventure', 'Animation', 'Children', 'Comedy', 'Crime', 'Documentary', 'Drama', 'Fantasy', 'Film-Noir', 'Horror', 'IMAX', 'Musical', 'Mystery', 'Romance', 'Sci-Fi', 'Thriller', 'War', 'Western'] not in index"
2025-07-10 13:36:42,453 - MovieRecommender - ERROR - logger:_log:507 - 请检查配置和数据文件
2025-07-10 13:36:42,473 - MovieRecommender - ERROR - logger:_log:507 - 程序执行失败
